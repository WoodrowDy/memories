# 프록시(proxy) ? 리버스 프록시 & 포워드 프록시

## 프록시
- 프록시는 클라이언트와 서버 사이에 위치한 중계 서버로 통신을 대신 수행하는 대리자 역할을 한다. 프록시가 없다면 클라이언트는 서버와 직접 통신한다. 반면, 클라이언트와 서버 사이에 프록시 서버가 있다면, 클라이언트와 서버는 프록시를 한번 거쳐 통신하게된다.
- 프록시는 프록시 서버의 위치에 따라 유형이 나뉜다.

### 왜 프록시를 사용하는가?
- 보안을 강화할 수 있고, 통신 성능을 높여주고, 통신 비용을 절약할 수 있다.

## 포워드 프록시
- 일반적으로 사람들이 떠올리는 프록시의 유형이다. 포워드 프록시는 클라이언트와 인터넷 사이에 위치해있다. 이로 인해 클라이언트의 정보가 서버측에 노출되지 않는다.
- 용도
  - 캐싱
    - 프록시를 사용하면 자주 사용되는 HTML, JS, CSS, 이미지와 같은 정적 파일들을 원 서버로부터 캐싱하고, 클라이언트가 요청할 때 원 서버로 요청하는 대신 가지고 있는 캐시로 응답할 수 있다.
  - 특정 컨텐츠 엑세스 제한
    - 학교 혹은 사내의 내부망에 프록시 서버를 두어 특정 컨텐츠에 대한 액세스를 제한할 수 있다
    - ex) 유해 사이트 차단
  - 익명성 확보
    - 모든 요청이 프록시 서버를 통해 발생하므로 클라이언트는 인터넷에서 자신을 숨길 수 있다. 클라이언트의 진짜 IP 주소가 노출되는 것을 원치 않을 경우 프록시 서버를 경유할 수 있다.

## 리버스 프록시
- 리버스 프록시는 서버와 인터넷 사이에 위치한 프록시 서버이다. 클라이언트의 요청을 서버 대신 받게된다. 이런 구조에서는 클라이언트는 프록시 뒤의 서버의 존재를 모르게 되며, 웹 서버에 요청하듯이 프록시 서버에 요청하게 될 것이다.
- 용도
  - 캐싱
  - 로드밸런싱
    - 인기 있는 서비스는 하루에도 매일 수백만명의 트래픽이 들어올 것 이다. 이를 하나의 서버를 두어 처리하는 것은 무리가 있을 것 이다. 따라서 수평 확장(scale out)을 하여 다중 서버 환경을 구축하게 될 것이다. 이때 프록시는 여러 서버에 각각 부하를 분산하여 한 서버에 집중적으로 부하가 몰리는 상황을 방지하는 역할을 할 수 있다. 혹은 몇 서버가 장애가 발생했을 때 해당 서버로 요청을 보내지 않도록 설정할수도 있을 것 이다.
  - 무중단 배포
    - 프록시 서버 뒤에 서버가 3대 있다고 가정하자. 아무 조치 없이 배포를 위해 모든 서버를 한번에 종료하고, 새로운 버전을 보내 실행하면 사용자는 그 찰나의 시간동안 서비스를 이용할 수 없게 될 것이다.
    - 한 서버가 배포중일 때에는 프록시가 그 서버로 요청을 전달하지 않는 것. 
      - 로드밸런싱이 "부하 분산"에 초점을 맞춘다면, 무중단 배포는 이 기술을 "버전 전환"을 위해 활용 -> 로드밸런싱을 응용한 사례
  - DDos 공격으로부터 보호
    - 서버 앞단에 프록시를 두게 되면 서버는 인터넷으로부터 숨겨진다. 외부에서는 서버의 IP를 알 수 없을 것 이다. 이렇게 되면 공격자는 DDoS 등의 공격 대상으로 실제 서버를 두기 어려울 것 이다. 즉, 공격자는 리버스 프록시 서버만 공격 대상으로 설정할 수 있을 것 이다. 이로 인해 실제 서버를 여러 공격으로부터 보호할 수 있다.
  - SSL 암호화
    - SSL Termination / SSL pass-through / SSL bridging
    - 일반적으로 SSL Termination 많이 사용함
    - SSL Termination
      - 리버스 프록시에서 가장 일반적으로 사용되는 방식입니다
      - 클라이언트와 리버스 프록시 사이에만 SSL/TLS 암호화를 적용합니다
      - 리버스 프록시가 SSL 인증서를 관리하고 암호화/복호화를 처리합니다
      - 내부 네트워크의 백엔드 서버들은 일반 HTTP 통신을 사용할 수 있어 서버 부하가 감소합니다

